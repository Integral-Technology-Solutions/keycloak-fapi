{
    "test-name": "fapi-rw-id2-discovery-end-point-verification",
    "variant": {
        "fapi_profile": "openbanking_uk"
    },
    "configuration-filename": "authlete-*.json",
    "current-block": "",
    "condition": "CheckJwksUriIsHostedOnOpenBankingDirectory",
    "expected-result": "warning"
}

{
    "test-name": "fapi-rw-id2-attempt-reuse-authorisation-code-after-one-second",
    "variant": "*",
    "configuration-filename": "authlete*.json",
    "current-block": "Attempting reuse of authorisation code & testing if access token is revoked",
    "condition": "CallProtectedResourceWithBearerTokenExpectingError",
    "expected-result": "warning"
}

{
    "test-name": "fapi-rw-id2-attempt-reuse-authorisation-code-after-30seconds",
    "variant": "*",
    "configuration-filename": "authlete*.json",
    "current-block": "Attempting reuse of authorisation code & testing if access token is revoked",
    "condition": "CallProtectedResourceWithBearerTokenExpectingError",
    "expected-result": "warning"
}

{
    "test-name": "fapi-rw-id2-ensure-server-handles-non-matching-intent-id",
    "variant": {
        "fapi_profile": "openbanking_uk"
    },
    "configuration-filename": "authlete-*.json",
    "current-block": "Verify authorization endpoint response",
    "condition": "EnsureErrorFromAuthorizationEndpointResponse",
    "expected-result": "failure"
}

{
    "test-name": "fapi-rw-id2-ensure-server-handles-non-matching-intent-id",
    "variant": {
        "fapi_profile": "openbanking_uk"
    },
    "configuration-filename": "authlete-*.json",
    "current-block": "Verify authorization endpoint response",
    "condition": "EnsureInvalidRequestInvalidRequestObjectInvalidRequestUriOrAccessDeniedError",
    "expected-result": "failure"
}

{
    "test-name": "fapi-rw-id2-ensure-server-handles-non-matching-intent-id",
    "variant": {
        "fapi_profile": "openbanking_uk"
    },
    "configuration-filename": "authlete-*.json",
    "current-block": "Verify authorization endpoint response",
    "condition": "CheckForUnexpectedParametersInErrorResponseFromAuthorizationEndpoint",
    "expected-result": "warning"
}

{
    "test-name": "fapi-rw-id2-refresh-token",
    "variant": {
        "client_auth_type": "private_key_jwt",
        "fapi_profile": "openbanking_uk",
        "fapi_response_mode": "plain_response"
    },
    "configuration-filename": "authlete-fapi-rw-id2-ob-privatekey.json",
    "current-block": "Second client: Check for refresh token",
    "condition": "FAPIEnsureServerConfigurationDoesNotSupportRefreshToken",
    "expected-result": "warning"
}

{
    "test-name": "oidcc-codereuse-30seconds",
    "variant": "*",
    "configuration-filename": "authlete-*.json",
    "current-block": "Testing if access token was revoked after the authorization code was reused",
    "condition": "CallProtectedResourceWithBearerTokenExpectingError",
    "expected-result": "warning"
}

{
    "test-name": "oidcc-server-rotate-keys",
    "variant": "*",
    "configuration-filename": "authlete-*.json",
    "current-block": "",
    "condition": "VerifyNewJwksHasNewSigningKey",
    "expected-result": "failure"
}

{
    "test-name": "oidcc-userinfo-post-body",
    "variant": "*",
    "configuration-filename": "authlete-*.json",
    "current-block": "",
    "condition": "UserInfoEndpointWithAccessTokenInBodyNotSupported",
    "expected-result": "warning"
}

